#!/usr/bin/env python2.7
import os

from github import Github

username = os.environ['GHUSER']
password = os.environ['GHPASSWORD']


g = Github(username, password)



# for repo in g.get_user().get_repos():
#     print dir(repo)
#     print repo.name, repo.organization
#     print

login = 'restlessbandit'

for org in g.get_user().get_orgs():
    if login == org.login:
        break
    print org, org.name, org.company, org.etag, org.login
else:
    raise ValueError('{} not found'.format(login))

for repo in org.get_repos():
    print repo.name, repo.default_branch, repo.clone_url
    #print repo.clone_url.replace(
    #    'https://github.com', 'https://{username}:{password}@github.com'.format(
    #        username=username, password=password))

    clone_url = 'git@github.com:{login}/{repo_name}.git'.format(
        login=login, repo_name=repo.name)

    import subprocess
    p = subprocess.Popen(['git', 'clone', clone_url])
    p.wait()
    break
